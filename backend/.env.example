# backend/.env.example - safe example (DO NOT COMMIT secrets)
# Copy this to backend/.env and fill the real values (do NOT commit .env)

# Database: default for local dev is SQLite. For production, provide a
# PostgreSQL connection string (example below).
DATABASE_URL=sqlite:///./dev.db
# Example PostgreSQL URL (commented):
# DATABASE_URL=postgresql+psycopg2://user:password@localhost:5432/horus_db

# SRT stream (example, usually secret)
# SRT_STREAM_URL_GLOBO=srt://<host>:<port>?mode=caller&latency=4000&passphrase=<secret>&pbkeylen=16

# Logging and runtime
LOG_LEVEL=INFO
FFMPEG_PATH=ffmpeg

# Model paths (relative to backend/app). Update if you put models elsewhere.
VIDEO_MODEL_PATH=app/ml/models/video_model_quant.tflite
AUDIO_MODEL_PATH=app/ml/models/audio_model_quant.tflite

# Video stabilization / detection tuning
# Number of consecutive frames (K) required to consider a detection
VIDEO_VOTE_K=3

# Window size (M) for moving average of confidence
VIDEO_MOVING_AVG_M=5

# Heuristics & thresholds
VIDEO_BLUR_VAR_THRESHOLD=518.0
VIDEO_BRIGHTNESS_LOW=30
VIDEO_BRIGHTNESS_DROP_RATIO=0.25

# If false (default), audio analysis will NOT be allowed to override a visual-only
# detection. Set to true if you want audio to be able to change the final label.
VIDEO_ALLOW_AUDIO_OVERRIDE=false
# When true, the backend will skip audio model loading and analysis entirely.
# This forces visual-only processing (recommended default for deployments that
# want to avoid audio-driven false positives). Set to `false` to enable audio
# processing and allow audio to be considered for fusion/override.
VIDEO_DISABLE_AUDIO_PROCESSING=true

# Per-class thresholds (use the model's label name in uppercase, normalized)
# Example: if model emits 'BORRADO' or 'blurry' map to VIDEO_THRESH_<NAME>
VIDEO_THRESH_BORRADO=0.7
VIDEO_THRESH_BLOCO=0.7

# Default threshold used when no per-class threshold is specified
VIDEO_THRESH_DEFAULT=0.7

# Output directories (relative to backend/app/static)
HLS_OUTPUT_DIR=static/hls
CLIPS_OUTPUT_DIR=static/clips
DIAGNOSTICS_DIR=static/diagnostics

# Notes:
# - Copy this file to `backend/.env` and adjust values before running the backend.
# - For production, provide a secure DATABASE_URL (Postgres) and set
#   VIDEO_ALLOW_AUDIO_OVERRIDE according to your ops requirements.
# - You can override any of these with environment variables in your deployment.

# Other options: add VIDEO_CLASSES as comma-separated list if useful for your ops
# VIDEO_CLASSES=BORRADO,BLOCO,OUTRA_CLASSE
